---
source: parser/src/parser/parser.rs
description: "def _handle_ticker_index(symbol):\n    ticker_index = symbols_data.get_ticker_index(symbol)\n\n    if ticker_index is None:\n        market_symbol = get_symbol_info(symbol)\n        if market_symbol is not None:\n            symbols_data.append_symbol_to_file(market_symbol)\n            ticker_index = market_symbol.index\n    return ticker_index\n\n\ndef _extract_ticker_client_types_data(ticker_index: str) -> List:\n    url = TSE_CLIENT_TYPE_DATA_URL.format(ticker_index)\n    with requests_retry_session() as session:\n        response = session.get(url, timeout=5)\n    data = response.text.split(';')\n    return data\n"
input_file: parser/test_data/inputs/functions.py
---
Module {
    node: Node {
        start: 0,
        end: 609,
    },
    body: [
        FunctionDef(
            FunctionDef {
                node: Node {
                    start: 0,
                    end: 342,
                },
                name: "_handle_ticker_index",
                args: Arguments {
                    node: Node {
                        start: 25,
                        end: 31,
                    },
                    posonlyargs: [],
                    args: [
                        Arg {
                            node: Node {
                                start: 25,
                                end: 31,
                            },
                            arg: "symbol",
                            annotation: None,
                        },
                    ],
                    vararg: None,
                    kwonlyargs: [],
                    kw_defaults: [],
                    kwarg: None,
                    defaults: [],
                },
                body: [
                    AssignStatement(
                        Assign {
                            node: Node {
                                start: 38,
                                end: 90,
                            },
                            targets: [
                                Name(
                                    Name {
                                        node: Node {
                                            start: 38,
                                            end: 50,
                                        },
                                        id: "ticker_index",
                                    },
                                ),
                            ],
                            value: Call(
                                Call {
                                    node: Node {
                                        start: 82,
                                        end: 90,
                                    },
                                    func: Attribute(
                                        Attribute {
                                            node: Node {
                                                start: 53,
                                                end: 82,
                                            },
                                            value: Name(
                                                Name {
                                                    node: Node {
                                                        start: 53,
                                                        end: 65,
                                                    },
                                                    id: "symbols_data",
                                                },
                                            ),
                                            attr: "get_ticker_index",
                                        },
                                    ),
                                    args: [
                                        Name(
                                            Name {
                                                node: Node {
                                                    start: 83,
                                                    end: 89,
                                                },
                                                id: "symbol",
                                            },
                                        ),
                                    ],
                                    keywords: [],
                                    starargs: None,
                                    kwargs: None,
                                },
                            ),
                        },
                    ),
                    IfStatement(
                        If {
                            node: Node {
                                start: 96,
                                end: 320,
                            },
                            test: Compare(
                                Compare {
                                    node: Node {
                                        start: 99,
                                        end: 119,
                                    },
                                    left: Name(
                                        Name {
                                            node: Node {
                                                start: 99,
                                                end: 111,
                                            },
                                            id: "ticker_index",
                                        },
                                    ),
                                    ops: [
                                        Is,
                                    ],
                                    comparators: [
                                        Constant(
                                            Constant {
                                                node: Node {
                                                    start: 115,
                                                    end: 119,
                                                },
                                                value: None,
                                            },
                                        ),
                                    ],
                                },
                            ),
                            body: [
                                AssignStatement(
                                    Assign {
                                        node: Node {
                                            start: 129,
                                            end: 168,
                                        },
                                        targets: [
                                            Name(
                                                Name {
                                                    node: Node {
                                                        start: 129,
                                                        end: 142,
                                                    },
                                                    id: "market_symbol",
                                                },
                                            ),
                                        ],
                                        value: Call(
                                            Call {
                                                node: Node {
                                                    start: 145,
                                                    end: 168,
                                                },
                                                func: Name(
                                                    Name {
                                                        node: Node {
                                                            start: 145,
                                                            end: 160,
                                                        },
                                                        id: "get_symbol_info",
                                                    },
                                                ),
                                                args: [
                                                    Name(
                                                        Name {
                                                            node: Node {
                                                                start: 161,
                                                                end: 167,
                                                            },
                                                            id: "symbol",
                                                        },
                                                    ),
                                                ],
                                                keywords: [],
                                                starargs: None,
                                                kwargs: None,
                                            },
                                        ),
                                    },
                                ),
                                IfStatement(
                                    If {
                                        node: Node {
                                            start: 177,
                                            end: 320,
                                        },
                                        test: Compare(
                                            Compare {
                                                node: Node {
                                                    start: 180,
                                                    end: 205,
                                                },
                                                left: Name(
                                                    Name {
                                                        node: Node {
                                                            start: 180,
                                                            end: 193,
                                                        },
                                                        id: "market_symbol",
                                                    },
                                                ),
                                                ops: [
                                                    IsNot,
                                                ],
                                                comparators: [
                                                    Constant(
                                                        Constant {
                                                            node: Node {
                                                                start: 201,
                                                                end: 205,
                                                            },
                                                            value: None,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                        body: [
                                            ExpressionStatement(
                                                Call(
                                                    Call {
                                                        node: Node {
                                                            start: 253,
                                                            end: 268,
                                                        },
                                                        func: Attribute(
                                                            Attribute {
                                                                node: Node {
                                                                    start: 219,
                                                                    end: 253,
                                                                },
                                                                value: Name(
                                                                    Name {
                                                                        node: Node {
                                                                            start: 219,
                                                                            end: 231,
                                                                        },
                                                                        id: "symbols_data",
                                                                    },
                                                                ),
                                                                attr: "append_symbol_to_file",
                                                            },
                                                        ),
                                                        args: [
                                                            Name(
                                                                Name {
                                                                    node: Node {
                                                                        start: 254,
                                                                        end: 267,
                                                                    },
                                                                    id: "market_symbol",
                                                                },
                                                            ),
                                                        ],
                                                        keywords: [],
                                                        starargs: None,
                                                        kwargs: None,
                                                    },
                                                ),
                                            ),
                                            AssignStatement(
                                                Assign {
                                                    node: Node {
                                                        start: 281,
                                                        end: 315,
                                                    },
                                                    targets: [
                                                        Name(
                                                            Name {
                                                                node: Node {
                                                                    start: 281,
                                                                    end: 293,
                                                                },
                                                                id: "ticker_index",
                                                            },
                                                        ),
                                                    ],
                                                    value: Attribute(
                                                        Attribute {
                                                            node: Node {
                                                                start: 296,
                                                                end: 315,
                                                            },
                                                            value: Name(
                                                                Name {
                                                                    node: Node {
                                                                        start: 296,
                                                                        end: 309,
                                                                    },
                                                                    id: "market_symbol",
                                                                },
                                                            ),
                                                            attr: "index",
                                                        },
                                                    ),
                                                },
                                            ),
                                        ],
                                        orelse: [],
                                    },
                                ),
                            ],
                            orelse: [],
                        },
                    ),
                    Return(
                        Return {
                            node: Node {
                                start: 320,
                                end: 339,
                            },
                            value: Some(
                                Name(
                                    Name {
                                        node: Node {
                                            start: 327,
                                            end: 339,
                                        },
                                        id: "ticker_index",
                                    },
                                ),
                            ),
                        },
                    ),
                ],
                decorator_list: [],
                returns: None,
                type_comment: None,
            },
        ),
        FunctionDef(
            FunctionDef {
                node: Node {
                    start: 342,
                    end: 609,
                },
                name: "_extract_ticker_client_types_data",
                args: Arguments {
                    node: Node {
                        start: 380,
                        end: 397,
                    },
                    posonlyargs: [],
                    args: [
                        Arg {
                            node: Node {
                                start: 380,
                                end: 397,
                            },
                            arg: "ticker_index",
                            annotation: Some(
                                Name(
                                    Name {
                                        node: Node {
                                            start: 394,
                                            end: 397,
                                        },
                                        id: "str",
                                    },
                                ),
                            ),
                        },
                    ],
                    vararg: None,
                    kwonlyargs: [],
                    kw_defaults: [],
                    kwarg: None,
                    defaults: [],
                },
                body: [
                    AssignStatement(
                        Assign {
                            node: Node {
                                start: 412,
                                end: 463,
                            },
                            targets: [
                                Name(
                                    Name {
                                        node: Node {
                                            start: 412,
                                            end: 415,
                                        },
                                        id: "url",
                                    },
                                ),
                            ],
                            value: Call(
                                Call {
                                    node: Node {
                                        start: 449,
                                        end: 463,
                                    },
                                    func: Attribute(
                                        Attribute {
                                            node: Node {
                                                start: 418,
                                                end: 449,
                                            },
                                            value: Name(
                                                Name {
                                                    node: Node {
                                                        start: 418,
                                                        end: 442,
                                                    },
                                                    id: "TSE_CLIENT_TYPE_DATA_URL",
                                                },
                                            ),
                                            attr: "format",
                                        },
                                    ),
                                    args: [
                                        Name(
                                            Name {
                                                node: Node {
                                                    start: 450,
                                                    end: 462,
                                                },
                                                id: "ticker_index",
                                            },
                                        ),
                                    ],
                                    keywords: [],
                                    starargs: None,
                                    kwargs: None,
                                },
                            ),
                        },
                    ),
                    WithStatement(
                        With {
                            node: Node {
                                start: 468,
                                end: 561,
                            },
                            items: [
                                WithItem {
                                    node: Node {
                                        start: 473,
                                        end: 508,
                                    },
                                    context_expr: Call(
                                        Call {
                                            node: Node {
                                                start: 473,
                                                end: 497,
                                            },
                                            func: Name(
                                                Name {
                                                    node: Node {
                                                        start: 473,
                                                        end: 495,
                                                    },
                                                    id: "requests_retry_session",
                                                },
                                            ),
                                            args: [],
                                            keywords: [],
                                            starargs: None,
                                            kwargs: None,
                                        },
                                    ),
                                    optional_vars: Some(
                                        Name(
                                            Name {
                                                node: Node {
                                                    start: 501,
                                                    end: 508,
                                                },
                                                id: "session",
                                            },
                                        ),
                                    ),
                                },
                            ],
                            body: [
                                AssignStatement(
                                    Assign {
                                        node: Node {
                                            start: 518,
                                            end: 556,
                                        },
                                        targets: [
                                            Name(
                                                Name {
                                                    node: Node {
                                                        start: 518,
                                                        end: 526,
                                                    },
                                                    id: "response",
                                                },
                                            ),
                                        ],
                                        value: Call(
                                            Call {
                                                node: Node {
                                                    start: 540,
                                                    end: 556,
                                                },
                                                func: Attribute(
                                                    Attribute {
                                                        node: Node {
                                                            start: 529,
                                                            end: 540,
                                                        },
                                                        value: Name(
                                                            Name {
                                                                node: Node {
                                                                    start: 529,
                                                                    end: 536,
                                                                },
                                                                id: "session",
                                                            },
                                                        ),
                                                        attr: "get",
                                                    },
                                                ),
                                                args: [
                                                    Name(
                                                        Name {
                                                            node: Node {
                                                                start: 541,
                                                                end: 544,
                                                            },
                                                            id: "url",
                                                        },
                                                    ),
                                                ],
                                                keywords: [
                                                    Keyword {
                                                        node: Node {
                                                            start: 546,
                                                            end: 555,
                                                        },
                                                        arg: Some(
                                                            "timeout",
                                                        ),
                                                        value: Constant(
                                                            Constant {
                                                                node: Node {
                                                                    start: 554,
                                                                    end: 555,
                                                                },
                                                                value: Int(
                                                                    "5",
                                                                ),
                                                            },
                                                        ),
                                                    },
                                                ],
                                                starargs: None,
                                                kwargs: None,
                                            },
                                        ),
                                    },
                                ),
                            ],
                        },
                    ),
                    AssignStatement(
                        Assign {
                            node: Node {
                                start: 561,
                                end: 592,
                            },
                            targets: [
                                Name(
                                    Name {
                                        node: Node {
                                            start: 561,
                                            end: 565,
                                        },
                                        id: "data",
                                    },
                                ),
                            ],
                            value: Call(
                                Call {
                                    node: Node {
                                        start: 587,
                                        end: 592,
                                    },
                                    func: Attribute(
                                        Attribute {
                                            node: Node {
                                                start: 568,
                                                end: 587,
                                            },
                                            value: Attribute(
                                                Attribute {
                                                    node: Node {
                                                        start: 568,
                                                        end: 581,
                                                    },
                                                    value: Name(
                                                        Name {
                                                            node: Node {
                                                                start: 568,
                                                                end: 576,
                                                            },
                                                            id: "response",
                                                        },
                                                    ),
                                                    attr: "text",
                                                },
                                            ),
                                            attr: "split",
                                        },
                                    ),
                                    args: [
                                        Constant(
                                            Constant {
                                                node: Node {
                                                    start: 588,
                                                    end: 591,
                                                },
                                                value: Str(
                                                    ";",
                                                ),
                                            },
                                        ),
                                    ],
                                    keywords: [],
                                    starargs: None,
                                    kwargs: None,
                                },
                            ),
                        },
                    ),
                    Return(
                        Return {
                            node: Node {
                                start: 597,
                                end: 608,
                            },
                            value: Some(
                                Name(
                                    Name {
                                        node: Node {
                                            start: 604,
                                            end: 608,
                                        },
                                        id: "data",
                                    },
                                ),
                            ),
                        },
                    ),
                ],
                decorator_list: [],
                returns: Some(
                    Name(
                        Name {
                            node: Node {
                                start: 402,
                                end: 406,
                            },
                            id: "List",
                        },
                    ),
                ),
                type_comment: None,
            },
        ),
    ],
}
